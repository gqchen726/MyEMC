package com.briup.accept;

import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;

import org.apache.log4j.Logger;


/**
 * 接收数据 
 * 
 * @author ghost
 * 
 */
public class AcceptImpl implements IAccept {
	private static final Logger logger = Logger.getLogger(AcceptImpl.class);
	/**
	 * 接收从客户端发送过来的数据 
	 * 有可能第一次发送过来的数据还没有接收完成，第二次就又发送过来数据（多线程）
	 */
	@SuppressWarnings("resource")
	@Override
	public void accept() {
		Socket socket = null;
		try {
			// 创建ServerSocket对象 
			int port = 8666;
			ServerSocket serverSocket = new ServerSocket(port);
			while (true) {
				logger.info("服务器已启动,正在监听8666端口号");
				logger.info("等待新的客户端连接");
				socket = serverSocket.accept();
				logger.info("客户端" + socket.getInetAddress() + "连接到服务器");
				// 创建一个线程交给线程去处理
				(new MyThread(socket)).start();
				logger.info("当前任务已交予子线程处理");
			}
		} catch (IOException e) {
			e.printStackTrace();
		}
	}

}
